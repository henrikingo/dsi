run:
  - id: ycsb_load-${mongodb_setup.mongod_config_file.storage.engine}
    type: ycsb
    "cmd": "cd YCSB/ycsb-mongodb; ${test_control.numactl} ./bin/ycsb load mongodb -s -P workloads/workloadShort -p mongodb.url=mongodb://${mongodb_setup.meta.hosts}/ycsb -threads 32; sleep 1"
  - id: ycsb_50read50update-${mongodb_setup.mongod_config_file.storage.engine}
    type: ycsb
    "cmd": "cd YCSB/ycsb-mongodb; ${test_control.numactl} ./bin/ycsb run mongodb -s -P workloads/workloadShort -p mongodb.url=mongodb://${mongodb_setup.meta.hosts}/ycsb -threads 64; sleep 1"


pre_task:
  - on_localhost:
      exec: $DSI_PATH/bin/setup-ycsb.sh
  - on_workload_client:
      exec: rm -rf ycsb*
  - on_workload_client:
      upload_files:
        ycsb.tar.gz: ycsb.tar.gz
      upload_repo_files:
  - on_workload_client:
      exec: |
        tar zxvf ycsb.tar.gz
        source /etc/profile.d/maven.sh && cd /home/ec2-user/YCSB/ycsb-mongodb && ./setup.sh

