task_name: genny_workloads
run:
  - id: InsertRemove
    type: genny
    cmd: |
      ./genny/build/src/driver/genny ./genny/src/driver/test/InsertRemove.yml -u "${mongodb_setup.meta.mongodb_url}" -m sys-perf -o ./genny-perf.json
    output_files:
      - genny-perf.json

pre_task:
  - on_workload_client:
      # sed -i is to modify the workload config file
      # to insert the correct mongo URI.
      # until Genny can read from CLI or something else
      exec: |
       set -eou pipefail

       # remove existing output file (if any) since genny appends
       rm -f ./genny-perf.json
